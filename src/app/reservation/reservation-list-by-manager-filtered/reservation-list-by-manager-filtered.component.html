<div @fadeIn class="p-10 container mx-auto">
  <!-- Comboboxes -->
  <div class="flex items-center justify-between mb-4">
    <div>
      <h2 class="text-xl font-semibold">Reservations</h2>
    </div>
    <div></div>
  </div>

  <div class="mb-4 flex gap-4">
    <!-- Year Selector -->
    <div class="relative">
      <label class="block text-gray-700">Select Year</label>
      <select
        (change)="onYearChange($event)"
        class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline"
      >
        <option value="" disabled selected>Select Year</option>

        <option *ngFor="let year of years" [value]="year">
          {{ year  }}
        </option>
      </select>
    </div>

    <!-- Month Selector -->
    <div class="relative">
      <label class="block text-gray-700">Select Month</label>
      <select
        (change)="onMonthChange($event)"
        class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline"
      >
        <option value="" disabled selected>Select Month</option>

        <option *ngFor="let month of months" [value]="month.value">
          {{ month.name }}
        </option>
      </select>
    </div>

 <!--    Branch Selector 
    <div class="relative">
      <label class="block text-gray-700">Select Branch</label>
      <select
        (change)="onBranchChange($event)"
        class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline"
      >
        <option value="" disabled selected>Select a branch</option>
        <option *ngFor="let branch of branchList" [value]="branch.id">
          {{ branch.name }}
        </option>
      </select>
    </div> -->

     <!-- New Client Name Filter -->
  <div class="relative">
    <label class="block text-gray-700">Filter by Client Name</label>
    <input
      type="text"
      (input)="onClientNameChange($event)"
      class="block w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 rounded shadow leading-tight focus:outline-none focus:shadow-outline"
      placeholder="Enter client name"
    />
  </div>

    <!-- Apply Filter Button -->
    <button
      (click)="updateCalendar()"
      class="bg-green-500 text-white rounded-full mt-5 text-center py-2 px-4 hover:bg-green-700 flex items-center justify-center"
      aria-label="Apply Filter"
      title="Apply Filter"
    >
      Apply
    </button>
  </div>

  <!-- Calendar Cards -->
  <div  @fadeIn class="container mx-auto p-2">
    <!-- Calendar Grid -->
    <div
      class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6"
    >
      <div 
        *ngFor="let item of calendarDays"
        class="bg-white border border-gray-200 rounded-lg shadow-sm flex flex-col"
      >
        <div @fadeIn class="p-2 flex-2">
          <div class="text-lg font-semibold text-gray-900 mb-2">
            {{ item.date | date : "MMMM d, y" }}
          </div>
          <div class="text-gray-700">
            <div  *ngFor="let schedule of item.schedules">
              <div class="my-2">
                <span class="font-semibold">Start Date:</span>
                <span>{{ formatDate(schedule.startDate) }}</span>
              </div>
              <div class="mb-4">
                <span class="font-semibold">End Date:</span>
                <span>{{ formatDate(schedule.endDate) }}</span>
              </div>

              <div
                class="px-4 py-2 text-white text-sm font-medium text-center flex justify-between items-center"
                [ngStyle]="{
                  'background-color':
                    schedule.availability == 'SCHEDULE' ? '#83e309' : '#ff3b3b',
                  'border-radius': '0 0 0.5rem 0.5rem'
                }"
              >
                <span>{{
                  schedule.availability == "SCHEDULE" ? "SCHEDULE" : "BLOCK"
                }}</span>

                <div class="flex space-x-2">
                  <!-- Wrapper with tooltip text -->
                  <div class="relative group">
                    <svg
                    *ngIf="schedule.availability === 'SCHEDULE' && isScheduleValid(schedule.startDate)"

                    (click)="createReservation(schedule.id)" 
                    class="h-8 w-8 text-slate-100 rounded-full hover:bg-white"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path stroke="none" d="M0 0h24v24H0z" />
                    <line x1="12" y1="5" x2="12" y2="19" />
                    <line x1="5" y1="12" x2="19" y2="12" />
                  </svg>
                  
                    <!-- Tooltip text -->
                    <div class="tooltip-text">Create a new Reservation</div>
                  </div>

                 
                </div>
              </div>
            </div>

            <!-- Reservations as Small Cards -->
            <div
              *ngFor="let reservation of item.reservations"
              class="my-2 bg-gray-100 border border-gray-300 rounded-lg p-2"
            >
            <p class="mt-2 text-base font-bold text-gray-600">
              <strong>Date:</strong> {{ reservation.startTime | date : "dd/MM/yyyy" }}
            </p>
            <p class="text-base font-bold text-gray-600">
              <strong>Time:</strong> {{ reservation.startTime | date : "HH:mm" }} -
              {{ reservation.endTime | date : "HH:mm" }}
            </p>
              <div class="mb-1">
                <span class="font-semibold">Client:</span>
                <span>{{ reservation.client.name }}</span>
              </div>

              <div class="mb-1">
                <span class="font-semibold">Service:</span>
                <span>{{ reservation.service.name }}</span>
              </div>

              <div class="flex justify-end">
                <button
                  [style.background-color]="reservation.status.color"
                  (click)="detail(reservation.id)"
                  class="bg-blue-500 text-white rounded px-2 py-1 text-sm hover:bg-blue-700"
                  aria-label="View Details"
                  title="View Details"
                >
                  View
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
